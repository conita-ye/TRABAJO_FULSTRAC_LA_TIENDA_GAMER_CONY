<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>La Tienda Gamer de Cony - Inicio de Sesi√≥n</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

  <style>
    body {
      background-color: #f3e8ff;
      color: #4b0082;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .gamer-btn {
      background: linear-gradient(135deg, #d8b4fe 0%, #fbcfe8 100%);
      border: none;
      font-weight: 700;
      color: #4b0082;
      transition: all 0.3s ease;
      padding: 12px 24px;
    }
    .gamer-btn:hover {
      background: linear-gradient(135deg, #c084fc 0%, #f9a8d4 100%);
      color: #3b0066;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(167, 139, 250, 0.3);
    }
    .form-control {
      background-color: #f9f5ff;
      border: 2px solid #d8b4fe;
      color: #4b0082;
      border-radius: 8px;
      padding: 12px 16px;
    }
    .form-control:focus {
      background-color: #f9f5ff;
      border-color: #a78bfa;
      box-shadow: 0 0 8px rgba(167, 139, 250, 0.4);
      color: #4b0082;
    }
    label {
      font-weight: 600;
      color: #6b21a8;
      margin-bottom: 8px;
    }
    a.text-success {
      color: #c084fc !important;
      transition: color 0.3s ease;
    }
    a.text-success:hover {
      color: #9333ea !important;
      text-decoration: underline;
    }
    .error-message {
      color: #db2777;
      font-size: 0.9rem;
      margin-top: 0.5rem;
      display: none;
      font-weight: 500;
    }
    .card {
      background-color: #ede9fe;
      border-radius: 20px;
      box-shadow: 0 12px 32px rgba(167, 139, 250, 0.3);
      border: none;
    }
    h3 {
      color: #7c3aed;
      font-weight: 800;
      text-shadow: 0 2px 4px rgba(167, 139, 250, 0.2);
      margin-bottom: 2rem !important;
    }
    .login-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .form-check-input {
      background-color: #f9f5ff;
      border: 2px solid #d8b4fe;
    }
    .form-check-input:checked {
      background-color: #a78bfa;
      border-color: #a78bfa;
    }
    hr {
      border-color: #d8b4fe !important;
      opacity: 0.6;
    }
  </style>
</head>
<body>

  <div class="login-container">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-md-8 col-lg-6 col-xl-5">
          <div class="card p-4 p-md-5">
            <!-- Logo y t√≠tulo -->
            <div class="text-center mb-4">
              <div style="font-size: 3rem; color: #7c3aed; margin-bottom: 1rem;">
                üéÆ
              </div>
              <h3>INICIO DE SESI√ìN</h3>
              <p class="text-muted" style="color: #6b21a8 !important;">Bienvenida a La Tienda Gamer de Cony</p>
            </div>

            <form id="formLogin" novalidate>
              <!-- Input para correo o tel√©fono -->
              <div class="form-group mb-4">
                <label for="userInput">üìß Correo electr√≥nico o üì± N√∫mero de tel√©fono</label>
                <input type="text" id="userInput" name="userInput" class="form-control form-control-lg" 
                       placeholder="ejemplo@duoc.cl o +56912345678" required />
                <div class="error-message" id="userInputError"></div>
              </div>

              <!-- Contrase√±a -->
              <div class="form-group mb-4">
                <label for="password">üîí Contrase√±a</label>
                <input type="password" id="password" name="password" class="form-control form-control-lg" 
                       placeholder="Ingresa tu contrase√±a" required />
                <div class="error-message" id="passwordError"></div>
              </div>

              <!-- Recordarme -->
              <div class="form-check mb-4">
                <input class="form-check-input" type="checkbox" id="recordarme" />
                <label class="form-check-label" for="recordarme">üíñ Recordarme en este dispositivo</label>
              </div>

              <!-- Bot√≥n Ingresar -->
              <button type="submit" class="btn btn-lg w-100 gamer-btn mb-4">
                üöÄ Ingresar
              </button>

              <hr class="my-4" />

              <div class="text-center">
                <p class="mb-2">
                  ¬øNo tienes cuenta? 
                  <a href="register.html" class="text-success"><u>Reg√≠strate aqu√≠</u></a>
                </p>

                <p class="mb-2">
                  ¬øOlvidaste tu contrase√±a? 
                  <a href="userRecovery.html" class="text-success"><u>Recuperar aqu√≠</u></a>
                </p>

                <p class="mb-0">
                  <a href="index.html" class="text-success"><u>‚Üê Volver al inicio</u></a>
                </p>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery (requerido por Bootstrap) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

  <!-- Bootstrap Bundle (con Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Base de datos simulada de usuarios
    const usuarios = [
      { 
        user: "co.yevenes@duoc.cl", 
        password: "1234",
        nombre: "Cony",
        tipo: "admin"
      },
      { 
        user: "profe@gmail.com", 
        password: "1234",
        nombre: "profe",
        tipo: "cliente"
      },
      { 
        user: "+56999408241", 
        password: "1212",
        nombre: "emy",
        tipo: "cliente"
      },
      { 
        user: "profe@duoc.cl", 
        password: "prof123",
        nombre: "Profesor",
        tipo: "admin"
      }
    ];

    document.getElementById('formLogin').addEventListener('submit', function(e) {
      e.preventDefault();

      // Limpiar errores
      const userInputError = document.getElementById('userInputError');
      const passwordError = document.getElementById('passwordError');
      userInputError.style.display = 'none';
      passwordError.style.display = 'none';

      const userInput = document.getElementById('userInput').value.trim();
      const password = document.getElementById('password').value;

      let valid = true;

      // Validar userInput: puede ser correo o tel√©fono
      if (!userInput) {
        userInputError.textContent = 'Este campo es obligatorio.';
        userInputError.style.display = 'block';
        valid = false;
      } else {
        // Validar correo
        const emailRegex = /^[a-zA-Z0-9._%+-]+@(duoc\.cl|profesor\.duoc\.cl|gmail\.com)$/;
        // Validar tel√©fono chileno (simplificado)
        const phoneRegex = /^(\+?56)?(\s?)(0?9)(\s?)[98765432]\d{7}$/;

        if (!emailRegex.test(userInput) && !phoneRegex.test(userInput)) {
          userInputError.textContent = 'Ingrese un correo v√°lido (@duoc.cl, @profesor.duoc.cl, @gmail.com) o un n√∫mero de tel√©fono chileno v√°lido.';
          userInputError.style.display = 'block';
          valid = false;
        }
      }

      // Validar contrase√±a
      if (!password) {
        passwordError.textContent = 'La contrase√±a es obligatoria.';
        passwordError.style.display = 'block';
        valid = false;
      } else if (password.length < 4 || password.length > 10) {
        passwordError.textContent = 'La contrase√±a debe tener entre 4 y 10 caracteres.';
        passwordError.style.display = 'block';
        valid = false;
      }

      if (valid) {
        // Buscar usuario en la base de datos simulada
        const usuarioEncontrado = usuarios.find(u => 
          u.user === userInput && u.password === password
        );

        if (usuarioEncontrado) {
          // Guardar informaci√≥n del usuario en localStorage
          localStorage.setItem('usuarioLogueado', JSON.stringify(usuarioEncontrado));
          
          // Mostrar mensaje de √©xito
          alert(`¬°Bienvenida ${usuarioEncontrado.nombre}! Inicio de sesi√≥n exitoso.`);
          
          // Redirigir a la p√°gina principal despu√©s de 1 segundo
          setTimeout(() => {
            window.location.href = 'index.html';
          }, 1000);
        } else {
          alert('‚ùå Usuario o contrase√±a incorrectos. Por favor, intenta nuevamente.');
        }
      }
    });

    // Verificar si ya hay una sesi√≥n activa
    window.addEventListener('load', function() {
      const usuarioLogueado = localStorage.getItem('usuarioLogueado');
      if (usuarioLogueado) {
        const usuario = JSON.parse(usuarioLogueado);
        alert(`Ya tienes una sesi√≥n activa como ${usuario.nombre}. Ser√°s redirigido...`);
        window.location.href = 'index.html';
      }
    });
  </script>
</body>
</html>